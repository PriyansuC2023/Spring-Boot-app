<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Books List</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        .btn {
            padding: 5px 10px;
            text-decoration: none;
            border: 1px solid #333;
            background-color: #eee;
            cursor: pointer;
        }
        .btn-danger {
            background-color: #ffdddd;
        }
        .btn-logout {
            background-color: #ffe4b5;
        }
    </style>
</head>
<body>

<!-- ===== TOP BAR ===== -->
<div class="top-bar">
    <h2>Books</h2>

    <!-- LOGOUT (POST + CSRF) -->
    <form th:action="@{/logout}" method="post">
        <input type="hidden"
               th:name="${_csrf.parameterName}"
               th:value="${_csrf.token}" />
        <button type="submit" class="btn btn-logout">
            Logout
        </button>
    </form>
</div>

<!-- ADD NEW BOOK -->
<a th:href="@{/ui/books/new}" class="btn">+ Add New Book</a>

<!-- ===== BOOKS TABLE ===== -->
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Author</th>
        <th>Description</th>
        <th>PDF</th>
        <th>Actions</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="book : ${books}">
        <td th:text="${book.id}"></td>
        <td th:text="${book.title}"></td>
        <td th:text="${book.author}"></td>
        <td th:text="${book.description}"></td>

        <!-- VIEW PDF -->
        <td>
            <a th:href="@{/ui/books/file/{id}(id=${book.id})}"
               target="_blank"
               class="btn">
                View PDF
            </a>
        </td>

        <!-- ACTIONS -->
        <td>

            <!-- EDIT -->
            <a th:href="@{/ui/books/edit/{id}(id=${book.id})}"
               class="btn">
                Edit
            </a>

            <!-- DELETE (POST + CSRF) -->
            <form th:action="@{/ui/books/delete/{id}(id=${book.id})}"
                  method="post"
                  style="display:inline">

                <input type="hidden"
                       th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}" />

                <button type="submit"
                        class="btn btn-danger"
                        onclick="return confirm('Are you sure you want to delete this book?')">
                    Delete
                </button>
            </form>

        </td>
    </tr>
    </tbody>
</table>

</body>
</html>